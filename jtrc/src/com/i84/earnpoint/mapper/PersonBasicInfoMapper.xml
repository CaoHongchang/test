<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.i84.earnpoint.mapper.PersonBasicInfoMapper">
	<resultMap id="BaseResultMap" type="com.i84.earnpoint.model.PersonBasicInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		<id column="id" property="id" jdbcType="INTEGER" />
		<result column="org_code" property="orgCode" jdbcType="VARCHAR" />
		<result column="person_name" property="personName" jdbcType="VARCHAR" />
		<result column="sex" property="sex" jdbcType="CHAR" />
		<result column="identity_number" property="identityNumber"
			jdbcType="VARCHAR" />
		<result column="ethnic" property="ethnic" jdbcType="VARCHAR" />
		<result column="birthday" property="birthday" jdbcType="DATE" />
		<result column="political_status" property="politicalStatus"
			jdbcType="VARCHAR" />
		<result column="native_place" property="nativePlace" jdbcType="VARCHAR" />
		<result column="registered_place" property="registeredPlace"
			jdbcType="VARCHAR" />
		<result column="telephone" property="telephone" jdbcType="VARCHAR" />
		<result column="title" property="title" jdbcType="VARCHAR" />
		<result column="industry" property="industry" jdbcType="VARCHAR" />
		<result column="address" property="address" jdbcType="VARCHAR" />
		<result column="wechat" property="wechat" jdbcType="VARCHAR" />
		<result column="qq" property="qq" jdbcType="VARCHAR" />
		<result column="email" property="email" jdbcType="VARCHAR" />
		<result column="train_record" property="trainRecord" jdbcType="LONGVARCHAR" />
		<result column="achievement" property="achievement" jdbcType="LONGVARCHAR" />
		<result column="status" property="status" jdbcType="CHAR" />
		<result column="uid" property="uid" jdbcType="INTEGER" />
		<result column="content" property="content" jdbcType="VARCHAR" />
		<result column="name" property="name" jdbcType="VARCHAR" />
	</resultMap>
	<sql id="Base_Column_List">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		id, org_code, person_name, sex, identity_number, ethnic, birthday,
		political_status,
		native_place, registered_place, telephone, title,
		industry, address, wechat, qq,
		email,train_record, achievement, status,
		uid, content
	</sql>
	<select id="selectPersonList" parameterType="java.util.Map"
		resultType="java.util.Map">
		select p.*,e.name from person_basic_info p LEFT JOIN enterprise_info e
		on e.c_code=p.org_code where 1=1
		<if test="person_name != null">
			and p.person_name LIKE
			CONCAT('%',#{person_name,jdbcType=VARCHAR},'%')
			or p.identity_number
			LIKE
			CONCAT('%',#{person_name,jdbcType=VARCHAR},'%')
		</if>
		<if test="status != null">
			<if test="status == 9">
				and (p.status is null or p.status ='9')
			</if>
			<if test="status == 0">
				and p.status = '0'
			</if>
			<if test="status == 1">
				and p.status = '1'
			</if>
			<if test="status == 2">
				and p.status = '2'
			</if>
		</if>
		order by p.id
	</select>
	<select id="qryPersonBasic" parameterType="java.util.Map"
		resultType="java.util.Map">
		select p.*,e.name from person_basic_info p LEFT JOIN
		enterprise_info e on
		e.c_code=p.org_code
		where p.id =
		#{id,jdbcType=INTEGER}
	</select>

	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		select
		<include refid="Base_Column_List" />
		from person_basic_info
		where id = #{id,jdbcType=INTEGER}
	</select>
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		delete from person_basic_info
		where id = #{id,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.i84.earnpoint.model.PersonBasicInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		insert into person_basic_info (id, org_code, person_name,
		sex,
		identity_number, ethnic,
		birthday, political_status, native_place,
		registered_place, telephone, title,
		industry, address, wechat,
		qq,
		email, status, uid,
		content, train_record, achievement
		)
		values
		(#{id,jdbcType=INTEGER}, #{orgCode,jdbcType=VARCHAR},
		#{personName,jdbcType=VARCHAR},
		#{sex,jdbcType=CHAR},
		#{identityNumber,jdbcType=VARCHAR}, #{ethnic,jdbcType=VARCHAR},
		#{birthday,jdbcType=DATE}, #{politicalStatus,jdbcType=VARCHAR},
		#{nativePlace,jdbcType=VARCHAR},
		#{registeredPlace,jdbcType=VARCHAR},
		#{telephone,jdbcType=VARCHAR}, #{title,jdbcType=VARCHAR},
		#{industry,jdbcType=VARCHAR}, #{address,jdbcType=VARCHAR},
		#{wechat,jdbcType=VARCHAR},
		#{qq,jdbcType=VARCHAR},
		#{email,jdbcType=VARCHAR}, #{status,jdbcType=CHAR},
		#{uid,jdbcType=INTEGER},
		#{content,jdbcType=VARCHAR},
		#{trainRecord,jdbcType=LONGVARCHAR},
		#{achievement,jdbcType=LONGVARCHAR}
		)
	</insert>
	<insert id="insertSelective" parameterType="com.i84.earnpoint.model.PersonBasicInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		insert into person_basic_info
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="id != null">
				id,
			</if>
			<if test="orgCode != null">
				org_code,
			</if>
			<if test="personName != null">
				person_name,
			</if>
			<if test="sex != null">
				sex,
			</if>
			<if test="identityNumber != null">
				identity_number,
			</if>
			<if test="ethnic != null">
				ethnic,
			</if>
			<if test="birthday != null">
				birthday,
			</if>
			<if test="politicalStatus != null">
				political_status,
			</if>
			<if test="nativePlace != null">
				native_place,
			</if>
			<if test="registeredPlace != null">
				registered_place,
			</if>
			<if test="telephone != null">
				telephone,
			</if>
			<if test="title != null">
				title,
			</if>
			<if test="industry != null">
				industry,
			</if>
			<if test="address != null">
				address,
			</if>
			<if test="wechat != null">
				wechat,
			</if>
			<if test="qq != null">
				qq,
			</if>
			<if test="email != null">
				email,
			</if>
			<if test="status != null">
				status,
			</if>
			<if test="uid != null">
				uid,
			</if>
			<if test="content != null">
				content,
			</if>
			<if test="trainRecord != null">
				train_record,
			</if>
			<if test="achievement != null">
				achievement,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="id != null">
				#{id,jdbcType=INTEGER},
			</if>
			<if test="orgCode != null">
				#{orgCode,jdbcType=VARCHAR},
			</if>
			<if test="personName != null">
				#{personName,jdbcType=VARCHAR},
			</if>
			<if test="sex != null">
				#{sex,jdbcType=CHAR},
			</if>
			<if test="identityNumber != null">
				#{identityNumber,jdbcType=VARCHAR},
			</if>
			<if test="ethnic != null">
				#{ethnic,jdbcType=VARCHAR},
			</if>
			<if test="birthday != null">
				#{birthday,jdbcType=DATE},
			</if>
			<if test="politicalStatus != null">
				#{politicalStatus,jdbcType=VARCHAR},
			</if>
			<if test="nativePlace != null">
				#{nativePlace,jdbcType=VARCHAR},
			</if>
			<if test="registeredPlace != null">
				#{registeredPlace,jdbcType=VARCHAR},
			</if>
			<if test="telephone != null">
				#{telephone,jdbcType=VARCHAR},
			</if>
			<if test="title != null">
				#{title,jdbcType=VARCHAR},
			</if>
			<if test="industry != null">
				#{industry,jdbcType=VARCHAR},
			</if>
			<if test="address != null">
				#{address,jdbcType=VARCHAR},
			</if>
			<if test="wechat != null">
				#{wechat,jdbcType=VARCHAR},
			</if>
			<if test="qq != null">
				#{qq,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				#{email,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				#{status,jdbcType=CHAR},
			</if>
			<if test="uid != null">
				#{uid,jdbcType=INTEGER},
			</if>
			<if test="content != null">
				#{content,jdbcType=VARCHAR},
			</if>
			<if test="trainRecord != null">
				#{trainRecord,jdbcType=LONGVARCHAR},
			</if>
			<if test="achievement != null">
				#{achievement,jdbcType=LONGVARCHAR},
			</if>
		</trim>
	</insert>
	<update id="updateByPrimaryKeySelective" parameterType="com.i84.earnpoint.model.PersonBasicInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		update person_basic_info
		<set>
			<if test="orgCode != null">
				org_code = #{orgCode,jdbcType=VARCHAR},
			</if>
			<if test="personName != null">
				person_name = #{personName,jdbcType=VARCHAR},
			</if>
			<if test="sex != null">
				sex = #{sex,jdbcType=CHAR},
			</if>
			<if test="identityNumber != null">
				identity_number = #{identityNumber,jdbcType=VARCHAR},
			</if>
			<if test="ethnic != null">
				ethnic = #{ethnic,jdbcType=VARCHAR},
			</if>
			<if test="birthday != null">
				birthday = #{birthday,jdbcType=DATE},
			</if>
			<if test="politicalStatus != null">
				political_status = #{politicalStatus,jdbcType=VARCHAR},
			</if>
			<if test="nativePlace != null">
				native_place = #{nativePlace,jdbcType=VARCHAR},
			</if>
			<if test="registeredPlace != null">
				registered_place = #{registeredPlace,jdbcType=VARCHAR},
			</if>
			<if test="telephone != null">
				telephone = #{telephone,jdbcType=VARCHAR},
			</if>
			<if test="title != null">
				title = #{title,jdbcType=VARCHAR},
			</if>
			<if test="industry != null">
				industry = #{industry,jdbcType=VARCHAR},
			</if>
			<if test="address != null">
				address = #{address,jdbcType=VARCHAR},
			</if>
			<if test="wechat != null">
				wechat = #{wechat,jdbcType=VARCHAR},
			</if>
			<if test="qq != null">
				qq = #{qq,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				email = #{email,jdbcType=VARCHAR},
			</if>
			<if test="status != null">
				status = #{status,jdbcType=CHAR},
			</if>
			<if test="uid != null">
				uid = #{uid,jdbcType=INTEGER},
			</if>
			<if test="content != null">
				content = #{content,jdbcType=VARCHAR},
			</if>
			<if test="trainRecord != null">
				train_record = #{trainRecord,jdbcType=LONGVARCHAR},
			</if>
			<if test="achievement != null">
				achievement = #{achievement,jdbcType=LONGVARCHAR},
			</if>
		</set>
		where id = #{id,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKeyWithBLOBs" parameterType="com.i84.earnpoint.model.PersonBasicInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		update person_basic_info
		set org_code = #{orgCode,jdbcType=VARCHAR},
		person_name = #{personName,jdbcType=VARCHAR},
		sex =
		#{sex,jdbcType=CHAR},
		identity_number =
		#{identityNumber,jdbcType=VARCHAR},
		ethnic =
		#{ethnic,jdbcType=VARCHAR},
		birthday = #{birthday,jdbcType=DATE},
		political_status = #{politicalStatus,jdbcType=VARCHAR},
		native_place =
		#{nativePlace,jdbcType=VARCHAR},
		registered_place =
		#{registeredPlace,jdbcType=VARCHAR},
		telephone =
		#{telephone,jdbcType=VARCHAR},
		title = #{title,jdbcType=VARCHAR},
		industry = #{industry,jdbcType=VARCHAR},
		address =
		#{address,jdbcType=VARCHAR},
		wechat = #{wechat,jdbcType=VARCHAR},
		qq =
		#{qq,jdbcType=VARCHAR},
		email = #{email,jdbcType=VARCHAR},
		status =
		#{status,jdbcType=CHAR},
		uid = #{uid,jdbcType=INTEGER},
		content =
		#{content,jdbcType=VARCHAR},
		train_record =
		#{trainRecord,jdbcType=LONGVARCHAR},
		achievement =
		#{achievement,jdbcType=LONGVARCHAR}
		where id = #{id,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.i84.earnpoint.model.PersonBasicInfo">
		<!-- WARNING - @mbggenerated This element is automatically generated by 
			MyBatis Generator, do not modify. This element was generated on Sat Oct 22 
			15:16:07 CST 2016. -->
		update person_basic_info
		set org_code = #{orgCode,jdbcType=VARCHAR},
		person_name = #{personName,jdbcType=VARCHAR},
		sex =
		#{sex,jdbcType=CHAR},
		identity_number =
		#{identityNumber,jdbcType=VARCHAR},
		ethnic =
		#{ethnic,jdbcType=VARCHAR},
		birthday = #{birthday,jdbcType=DATE},
		political_status = #{politicalStatus,jdbcType=VARCHAR},
		native_place =
		#{nativePlace,jdbcType=VARCHAR},
		registered_place =
		#{registeredPlace,jdbcType=VARCHAR},
		telephone =
		#{telephone,jdbcType=VARCHAR},
		title = #{title,jdbcType=VARCHAR},
		industry = #{industry,jdbcType=VARCHAR},
		address =
		#{address,jdbcType=VARCHAR},
		wechat = #{wechat,jdbcType=VARCHAR},
		qq =
		#{qq,jdbcType=VARCHAR},
		email = #{email,jdbcType=VARCHAR},
		status =
		#{status,jdbcType=CHAR},
		uid = #{uid,jdbcType=INTEGER},
		content =
		#{content,jdbcType=VARCHAR}
		where id = #{id,jdbcType=INTEGER}
	</update>
	<select id="countZrsList" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		SELECT
		YEAR (create_date) 'name',
		<if test="time_type == 'month' ">
			MONTH (create_date) 'month' ,
		</if>
		COUNT(1) 'num'
		FROM
		person_basic_info

		WHERE
		status = "1"
		<if test="t_start != '' ">
			AND create_date &gt;= #{t_start}
		</if>
		<if test=" t_end != ''  ">
			AND create_date &lt;= #{t_end}
		</if>
		GROUP BY
		YEAR (create_date)
		<if test="time_type == 'month' ">
			,MONTH (create_date)
		</if>
	</select>
	<select id="countByUnitList" parameterType="java.util.HashMap"
		resultType="java.util.HashMap">
		SELECT e.c_code,e.name,s.num
		FROM (select t.id, sum(t.num) AS num
		from
		(SELECT e.id,e.c_code,COUNT(1) 'num'
		FROM person_basic_info p LEFT JOIN
		enterprise_info e ON p.org_code =
		e.c_code WHERE
		p.status = "1" and
		e.parent_id = '-1'
		<if test="t_start != '' ">
			AND p.create_date &gt;= #{t_start}
		</if>
		<if test=" t_end != ''  ">
			AND p.create_date &lt;= #{t_end}
		</if>
		GROUP BY e.id
		union
		SELECT e.parent_id as id,e.c_code,COUNT(1) 'num'
		FROM person_basic_info p LEFT JOIN enterprise_info e ON p.org_code =
		e.c_code WHERE
		p.status = "1" and e.parent_id != '-1'
		<if test="t_start != '' ">
			AND p.create_date &gt;= #{t_start}
		</if>
		<if test=" t_end != ''  ">
			AND p.create_date &lt;= #{t_end}
		</if>
		GROUP BY e.parent_id) t group by t.id) s LEFT JOIN enterprise_info e
		ON s.id=e.id
	</select>

	<select id="degree" resultType="java.util.HashMap">
		SELECT
		sss.degree,COUNT(sss.degree)AS num FROM
		(SELECT
		pid,
		degree,
		graduate_date
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info p
		LEFT JOIN
		enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND p.status =
		'1') AS doem,
		`person_education_info` AS p
		WHERE p.`del_status` = "0"
		AND p.`pid` IN (doem.perId)
		GROUP BY pid
		ORDER BY `graduate_date` DESC )
		AS sss GROUP BY sss.degree
	</select>

	<select id="education" resultType="java.util.HashMap">
		SELECT
		sss.education,COUNT(sss.education)AS num FROM
		(SELECT
		pid,
		education,
		graduate_date
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info p
		LEFT JOIN
		enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND p.status =
		'1') AS doem,
		`person_education_info` AS p
		WHERE p.`del_status` = "0"
		AND p.`pid` IN (doem.perId)
		GROUP BY pid
		ORDER BY `graduate_date` DESC )
		AS sss GROUP BY sss.education
	</select>
	<select id="level" resultType="java.util.HashMap">
		SELECT sss.skill_level as
		level,COUNT(sss.skill_level)AS num FROM
		(SELECT
		skill_level
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info p
		LEFT JOIN enterprise_info e
		ON
		e.c_code = p.org_code
		WHERE 1 = 1
		AND p.status = '1') AS doem,
		`person_skill_certificate` AS p
		WHERE p.`del_status` = "0"
		AND p.`pid`
		IN (doem.perId)
		) AS sss GROUP BY sss.skill_level
	</select>

	<select id="professionalLevel" resultType="java.util.HashMap">
		SELECT
		sss.LEVEL,COUNT(sss.LEVEL)AS num FROM
		(SELECT
		LEVEL
		FROM
		(SELECT
		p.id AS
		perId
		FROM
		person_basic_info p
		LEFT JOIN enterprise_info e
		ON e.c_code =
		p.org_code
		WHERE 1 = 1
		AND p.status = '1') AS doem,
		`person_major_certificate` AS p
		WHERE p.`del_status` = "0"
		AND p.`pid`
		IN (doem.perId)
		) AS sss GROUP BY sss.LEVEL
	</select>

	<select id="rewardsAndPunishments" resultType="java.util.HashMap">
		SELECT
		sss.reward_level AS LEVEL,COUNT(sss.reward_level)AS num FROM
		(SELECT
		reward_level
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info p
		LEFT JOIN
		enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND p.status =
		'1') AS doem,
		`person_reward` AS p
		WHERE p.`del_status` = "0"
		AND p.`pid`
		IN (doem.perId)
		) AS sss GROUP BY sss.reward_level
	</select>

	<!-- 奖惩证书 -->
	<select id="certificateStatistics1" resultType="int">

		SELECT
		COUNT(person.id) AS rp
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info p
		LEFT JOIN enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND
		p.status = '1') AS doem,
		person_reward AS person
		WHERE
		person.`del_status` = "0"
		AND person.`pid` IN (doem.perId)

	</select>

	<!-- 技术等级证书 -->
	<select id="certificateStatistics2" resultType="int">
		SELECT
		COUNT(person.id) AS jsdj
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info
		p
		LEFT JOIN enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND
		p.status = '1') AS doem,
		person_skill_certificate AS person
		WHERE
		person.`del_status` = "0"
		AND person.`pid` IN (doem.perId)
	</select>

	<!-- 职业资格证书 -->
	<select id="certificateStatistics3" resultType="int">
		SELECT
		COUNT(person.id) AS zyzg
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info
		p
		LEFT JOIN enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND
		p.status = '1') AS doem,
		person_profession_certificate AS person
		WHERE
		person.`del_status` = "0"
		AND person.`pid` IN (doem.perId)
	</select>

	<!-- 专业技术职务资格证书 -->
	<select id="certificateStatistics4" resultType="int">
		SELECT
		COUNT(person.id) AS zyjs
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info
		p
		LEFT JOIN enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND
		p.status = '1') AS doem,
		person_major_certificate AS person
		WHERE
		person.`del_status` = "0"
		AND person.`pid` IN (doem.perId)
	</select>

	<!-- 特殊津贴 -->
	<select id="certificateStatistics5" resultType="int">
		SELECT
		COUNT(person.id) AS tsjt
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info
		p
		LEFT JOIN enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND
		p.status = '1') AS doem,
		person_state_allowance AS person
		WHERE
		person.`del_status` = "0"
		AND person.`pid` IN (doem.perId)
	</select>

	<!-- 学历信息 -->
	<select id="certificateStatistics6" resultType="int">
		SELECT
		COUNT(person.education) AS xlxx
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info p
		LEFT JOIN enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND p.status = '1') AS doem,
		person_education_info AS person
		WHERE person.`del_status` = "0"
		AND person.`pid` IN (doem.perId)
	</select>

	<!-- 学位证书 -->
	<select id="certificateStatistics7" resultType="int">
		SELECT
		COUNT(person.degree) AS xwzs
		FROM
		(SELECT
		p.id AS perId
		FROM
		person_basic_info p
		LEFT JOIN enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND p.status = '1') AS doem,
		person_education_info AS person
		WHERE person.`del_status` = "0"
		AND person.`pid` IN (doem.perId)
	</select>


	<select id="totalNumber" parameterType="com.i84.earnpoint.model.Statistical"
		resultType="java.util.HashMap">
		SELECT
		<if test="timeType==null or timeType=='year'">
			concat(YEAR(e.add_date),'年') year,
		</if>
		<if test=" timeType=='month'">
			concat(MONTH(e.add_date),'月') year,
		</if>
		COUNT(p.`id`) AS num
		FROM
		person_basic_info p
		LEFT JOIN enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND p.status = '1'
		<if test="year1 != null and year1 !='' ">
			AND e.add_date>=#{year1}
		</if>
		<if test="year2 != null and year2 !=''">
			AND #{year2} >=e.add_date
		</if>
		<if test="timeType==null or timeType=='year'">
			GROUP BY YEAR(e.add_date)
		</if>
		<if test=" timeType=='month'">
			GROUP BY MONTH(e.add_date)
		</if>
	</select>

	<select id="testLevel" parameterType="com.i84.earnpoint.model.Statistical"
		resultType="java.util.HashMap">
		SELECT
		dome.register_level AS LEVEL,
		COUNT(register_level) AS num
		FROM
		(SELECT
		education_num AS num,
		register_level
		FROM
		academic_education a
		WHERE a.del_date IS NULL
		AND a.status = '有效'
		<if test="year1 != null and year1 !='' ">
			AND a.start_time>=#{year1}
		</if>
		<if test="year2 != null and year2 !=''">
			AND #{year2} >=a.start_time
		</if>
		) AS dome,
		student_signup AS s
		WHERE s.`education_num` IN (dome.num)
		GROUP BY dome.register_level
	</select>

	<select id="unitStatistical" parameterType="com.i84.earnpoint.model.Statistical"
		resultType="java.util.HashMap">
		SELECT
		e.`name` AS nn,COUNT(NAME) AS num
		FROM
		person_basic_info p
		LEFT JOIN
		enterprise_info e
		ON e.c_code = p.org_code
		WHERE 1 = 1
		AND p.status ='1'
		GROUP BY e.`name`
	</select>

	<select id="formsOfLearning" parameterType="com.i84.earnpoint.model.Statistical"
		resultType="java.util.HashMap">
		SELECT
		dome.Learn_type AS learnType,
		COUNT(Learn_type) AS num
		FROM
		(SELECT
		education_num AS num,
		Learn_type
		FROM
		academic_education a
		WHERE
		a.del_date IS NULL
		AND a.status = '有效'
		<if test="year1 != null and year1 !='' ">
			AND a.start_time>=#{year1}
		</if>
		<if test="year2 != null and year2 !=''">
			AND #{year2} >=a.start_time
		</if>
		) AS dome,
		student_signup AS s
		WHERE s.`education_num` IN (dome.num)
		GROUP BY dome.Learn_type
	</select>


	<select id="school" parameterType="com.i84.earnpoint.model.Statistical"
		resultType="java.util.HashMap">
		SELECT
		dome.education_school AS school,
		COUNT(education_school) AS num
		FROM
		(SELECT
		education_num AS num,
		education_school
		FROM
		academic_education a
		WHERE a.del_date IS NULL
		AND a.status = '有效'
		<if test="year1 != null and year1 !='' ">
			AND a.start_time>=#{year1}
		</if>
		<if test="year2 != null and year2 !=''">
			AND #{year2} >=a.start_time
		</if>
		) AS dome,
		student_signup AS s
		WHERE s.`education_num` IN (dome.num)
		GROUP BY dome.education_school
	</select>

	<select id="major" parameterType="com.i84.earnpoint.model.Statistical"
		resultType="java.util.HashMap">
		SELECT
		dome.education_major AS major,
		COUNT(education_major) AS num
		FROM
		(SELECT
		education_num AS num,
		education_major
		FROM
		academic_education a
		WHERE a.del_date IS NULL
		AND a.status = '有效'
		<if test="year1 != null and year1 !='' ">
			AND a.start_time>=#{year1}
		</if>
		<if test="year2 != null and year2 !=''">
			AND #{year2} >=a.start_time
		</if>
		) AS dome,
		student_signup AS s
		WHERE s.`education_num` IN (dome.num)
		GROUP BY dome.education_major
	</select>

	<select id="countman" parameterType="com.i84.earnpoint.model.Statistical"
		resultType="java.util.HashMap">
		SELECT
		<if test="timeType==null or timeType=='year'">
			concat(YEAR(add_date),'年') year,
		</if>
		<if test=" timeType=='month'">
			concat(MONTH(add_date),'月') year,
		</if>
		COUNT(pnum) AS num
		FROM
		(SELECT
		education_num AS num
		FROM
		academic_education a
		WHERE a.del_date IS
		NULL
		AND a.status = '有效') AS dome,
		student_signup AS s
		WHERE
		s.`education_num` IN (dome.num)
		<if test="timeType==null or timeType=='year'">
			GROUP BY YEAR(add_date)
		</if>
		<if test=" timeType=='month'">
			GROUP BY MONTH(add_date)
		</if>
	</select>

	<select id="llr"  parameterType="com.i84.earnpoint.model.Statistical"
		resultType="java.util.HashMap">
		SELECT
		NAME AS ss,
		COUNT(NAME)AS num
		FROM
		(SELECT
		education_num AS num
		FROM
		academic_education a
		WHERE a.del_date IS NULL
		AND a.status = '有效'
		<if test="year1 != null and year1 !='' ">
			AND a.start_time>=#{year1}
		</if>
		<if test="year2 != null and year2 !=''">
			AND #{year2} >=a.start_time
		</if>
		) AS
		dome,
		student_signup AS s
		WHERE s.`education_num` IN (dome.num)
		GROUP BY
		NAME
	</select>
</mapper>