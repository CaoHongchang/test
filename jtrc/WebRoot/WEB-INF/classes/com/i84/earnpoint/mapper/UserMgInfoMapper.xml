<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.i84.earnpoint.mapper.UserMgInfoMapper">
  <resultMap id="BaseResultMap" type="com.i84.earnpoint.model.UserMgInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="uid" jdbcType="INTEGER" property="uid" />
    <result column="msgfrom" jdbcType="VARCHAR" property="msgfrom" />
    <result column="is_state" jdbcType="CHAR" property="isState" />
    <result column="smsg" jdbcType="VARCHAR" property="smsg" />
    <result column="dtype" jdbcType="VARCHAR" property="dtype" />
    <result column="dpno" jdbcType="VARCHAR" property="dpno" />
    <result column="is_s" jdbcType="VARCHAR" property="isS" />
    <result column="bd_unit" jdbcType="VARCHAR" property="bdUnit" />
    <result column="sp_date" jdbcType="TIMESTAMP" property="spDate" />
    <result column="unit_adr" jdbcType="VARCHAR" property="unitAdr" />
    <result column="bpno" jdbcType="VARCHAR" property="bpno" />
    <result column="ctype" jdbcType="VARCHAR" property="ctype" />
    <result column="license" jdbcType="VARCHAR" property="license" />
    <result column="home_tel" jdbcType="VARCHAR" property="homeTel" />
    <result column="home_adr" jdbcType="VARCHAR" property="homeAdr" />
    <result column="home_post" jdbcType="VARCHAR" property="homePost" />
    <result column="my_tel" jdbcType="VARCHAR" property="myTel" />
    <result column="my_adr" jdbcType="VARCHAR" property="myAdr" />
    <result column="my_post" jdbcType="VARCHAR" property="myPost" />
    <result column="wife_name" jdbcType="VARCHAR" property="wifeName" />
    <result column="wife_tel" jdbcType="VARCHAR" property="wifeTel" />
    <result column="create_date" jdbcType="TIMESTAMP" property="createDate" />
    <result column="out_date" jdbcType="TIMESTAMP" property="outDate" />
    <result column="del_date" jdbcType="TIMESTAMP" property="delDate" />
    <result column="point_proxy" jdbcType="VARCHAR" property="pointProxy" />
    <result column="human_out" jdbcType="VARCHAR" property="humanOut" />
    <result column="is_ad" jdbcType="VARCHAR" property="isAd" />
    <result column="pno" jdbcType="VARCHAR" property="pno" />
    <result column="human_out1" jdbcType="VARCHAR" property="humanOut1" />
    <result column="is_s1" jdbcType="VARCHAR" property="isS1" />
    <result column="point_proxy1" jdbcType="VARCHAR" property="pointProxy1" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    id, uid, msgfrom, is_state, smsg, dtype, dpno, is_s, bd_unit, sp_date, unit_adr, 
    bpno, ctype, license, home_tel, home_adr, home_post, my_tel, my_adr, my_post, wife_name, 
    wife_tel, create_date, out_date, del_date, point_proxy, human_out, is_ad, pno, human_out1, 
    is_s1, point_proxy1
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from user_mg_info
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from user_mg_info
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.i84.earnpoint.model.UserMgInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <!-- insert into user_mg_info (id, uid, msgfrom, 
      is_state, smsg, dtype, 
      dpno, is_s, bd_unit, 
      sp_date, unit_adr, bpno, 
      ctype, license, home_tel, 
      home_adr, home_post, my_tel, 
      my_adr, my_post, wife_name, 
      wife_tel, create_date, out_date, 
      del_date, point_proxy, human_out, 
      is_ad, pno, human_out1, 
      is_s1, point_proxy1)
    values (#{id,jdbcType=INTEGER}, #{uid,jdbcType=INTEGER}, #{msgfrom,jdbcType=VARCHAR}, 
      #{isState,jdbcType=CHAR}, #{smsg,jdbcType=VARCHAR}, #{dtype,jdbcType=VARCHAR}, 
      #{dpno,jdbcType=VARCHAR}, #{isS,jdbcType=VARCHAR}, #{bdUnit,jdbcType=VARCHAR}, 
      #{spDate,jdbcType=TIMESTAMP}, #{unitAdr,jdbcType=VARCHAR}, #{bpno,jdbcType=VARCHAR}, 
      #{ctype,jdbcType=VARCHAR}, #{license,jdbcType=VARCHAR}, #{homeTel,jdbcType=VARCHAR}, 
      #{homeAdr,jdbcType=VARCHAR}, #{homePost,jdbcType=VARCHAR}, #{myTel,jdbcType=VARCHAR}, 
      #{myAdr,jdbcType=VARCHAR}, #{myPost,jdbcType=VARCHAR}, #{wifeName,jdbcType=VARCHAR}, 
      #{wifeTel,jdbcType=VARCHAR}, #{createDate,jdbcType=TIMESTAMP}, #{outDate,jdbcType=TIMESTAMP}, 
      #{delDate,jdbcType=TIMESTAMP}, #{pointProxy,jdbcType=VARCHAR}, #{humanOut,jdbcType=VARCHAR}, 
      #{isAd,jdbcType=VARCHAR}, #{pno,jdbcType=VARCHAR}, #{humanOut1,jdbcType=VARCHAR}, 
      #{isS1,jdbcType=VARCHAR}, #{pointProxy1,jdbcType=VARCHAR}) -->
      insert into user_mg_info
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="uid != null">
        uid,
      </if>
      <if test="msgfrom != null">
        msgfrom,
      </if>
      <if test="isState != null">
        is_state,
      </if>
      <if test="smsg != null">
        smsg,
      </if>
      <if test="dtype != null">
        dtype,
      </if>
      <if test="dpno != null">
        dpno,
      </if>
      <if test="isS != null">
        is_s,
      </if>
      <if test="bdUnit != null">
        bd_unit,
      </if>
      <if test="spDate != null">
        sp_date,
      </if>
      <if test="unitAdr != null">
        unit_adr,
      </if>
      <if test="bpno != null">
        bpno,
      </if>
      <if test="ctype != null">
        ctype,
      </if>
      <if test="license != null">
        license,
      </if>
      <if test="homeTel != null">
        home_tel,
      </if>
      <if test="homeAdr != null">
        home_adr,
      </if>
      <if test="homePost != null">
        home_post,
      </if>
      <if test="myTel != null">
        my_tel,
      </if>
      <if test="myAdr != null">
        my_adr,
      </if>
      <if test="myPost != null">
        my_post,
      </if>
      <if test="wifeName != null">
        wife_name,
      </if>
      <if test="wifeTel != null">
        wife_tel,
      </if>
      <if test="createDate != null">
        create_date,
      </if>
      <if test="outDate != null">
        out_date,
      </if>
      <if test="delDate != null">
        del_date,
      </if>
      <if test="pointProxy != null">
        point_proxy,
      </if>
      <if test="humanOut != null">
        human_out,
      </if>
      <if test="isAd != null">
        is_ad,
      </if>
      <if test="pno != null">
        pno,
      </if>
      <if test="humanOut1 != null">
        human_out1,
      </if>
      <if test="isS1 != null">
        is_s1,
      </if>
      <if test="pointProxy1 != null">
        point_proxy1,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="uid != null">
        #{uid,jdbcType=INTEGER},
      </if>
      <if test="msgfrom != null">
        #{msgfrom,jdbcType=VARCHAR},
      </if>
      <if test="isState != null">
        #{isState,jdbcType=CHAR},
      </if>
      <if test="smsg != null">
        #{smsg,jdbcType=VARCHAR},
      </if>
      <if test="dtype != null">
        #{dtype,jdbcType=VARCHAR},
      </if>
      <if test="dpno != null">
        #{dpno,jdbcType=VARCHAR},
      </if>
      <if test="isS != null">
        #{isS,jdbcType=VARCHAR},
      </if>
      <if test="bdUnit != null">
        #{bdUnit,jdbcType=VARCHAR},
      </if>
      <if test="spDate != null">
        #{spDate,jdbcType=TIMESTAMP},
      </if>
      <if test="unitAdr != null">
        #{unitAdr,jdbcType=VARCHAR},
      </if>
      <if test="bpno != null">
        #{bpno,jdbcType=VARCHAR},
      </if>
      <if test="ctype != null">
        #{ctype,jdbcType=VARCHAR},
      </if>
      <if test="license != null">
        #{license,jdbcType=VARCHAR},
      </if>
      <if test="homeTel != null">
        #{homeTel,jdbcType=VARCHAR},
      </if>
      <if test="homeAdr != null">
        #{homeAdr,jdbcType=VARCHAR},
      </if>
      <if test="homePost != null">
        #{homePost,jdbcType=VARCHAR},
      </if>
      <if test="myTel != null">
        #{myTel,jdbcType=VARCHAR},
      </if>
      <if test="myAdr != null">
        #{myAdr,jdbcType=VARCHAR},
      </if>
      <if test="myPost != null">
        #{myPost,jdbcType=VARCHAR},
      </if>
      <if test="wifeName != null">
        #{wifeName,jdbcType=VARCHAR},
      </if>
      <if test="wifeTel != null">
        #{wifeTel,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null">
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="outDate != null">
        #{outDate,jdbcType=TIMESTAMP},
      </if>
      <if test="delDate != null">
        #{delDate,jdbcType=TIMESTAMP},
      </if>
      <if test="pointProxy != null">
        #{pointProxy,jdbcType=VARCHAR},
      </if>
      <if test="humanOut != null">
        #{humanOut,jdbcType=VARCHAR},
      </if>
      <if test="isAd != null">
        #{isAd,jdbcType=VARCHAR},
      </if>
      <if test="pno != null">
        #{pno,jdbcType=VARCHAR},
      </if>
      <if test="humanOut1 != null">
        #{humanOut1,jdbcType=VARCHAR},
      </if>
      <if test="isS1 != null">
        #{isS1,jdbcType=VARCHAR},
      </if>
      <if test="pointProxy1 != null">
        #{pointProxy1,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <insert id="insertSelective" parameterType="com.i84.earnpoint.model.UserMgInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into user_mg_info
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="uid != null">
        uid,
      </if>
      <if test="msgfrom != null">
        msgfrom,
      </if>
      <if test="isState != null">
        is_state,
      </if>
      <if test="smsg != null">
        smsg,
      </if>
      <if test="dtype != null">
        dtype,
      </if>
      <if test="dpno != null">
        dpno,
      </if>
      <if test="isS != null">
        is_s,
      </if>
      <if test="bdUnit != null">
        bd_unit,
      </if>
      <if test="spDate != null">
        sp_date,
      </if>
      <if test="unitAdr != null">
        unit_adr,
      </if>
      <if test="bpno != null">
        bpno,
      </if>
      <if test="ctype != null">
        ctype,
      </if>
      <if test="license != null">
        license,
      </if>
      <if test="homeTel != null">
        home_tel,
      </if>
      <if test="homeAdr != null">
        home_adr,
      </if>
      <if test="homePost != null">
        home_post,
      </if>
      <if test="myTel != null">
        my_tel,
      </if>
      <if test="myAdr != null">
        my_adr,
      </if>
      <if test="myPost != null">
        my_post,
      </if>
      <if test="wifeName != null">
        wife_name,
      </if>
      <if test="wifeTel != null">
        wife_tel,
      </if>
      <if test="createDate != null">
        create_date,
      </if>
      <if test="outDate != null">
        out_date,
      </if>
      <if test="delDate != null">
        del_date,
      </if>
      <if test="pointProxy != null">
        point_proxy,
      </if>
      <if test="humanOut != null">
        human_out,
      </if>
      <if test="isAd != null">
        is_ad,
      </if>
      <if test="pno != null">
        pno,
      </if>
      <if test="humanOut1 != null">
        human_out1,
      </if>
      <if test="isS1 != null">
        is_s1,
      </if>
      <if test="pointProxy1 != null">
        point_proxy1,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="uid != null">
        #{uid,jdbcType=INTEGER},
      </if>
      <if test="msgfrom != null">
        #{msgfrom,jdbcType=VARCHAR},
      </if>
      <if test="isState != null">
        #{isState,jdbcType=CHAR},
      </if>
      <if test="smsg != null">
        #{smsg,jdbcType=VARCHAR},
      </if>
      <if test="dtype != null">
        #{dtype,jdbcType=VARCHAR},
      </if>
      <if test="dpno != null">
        #{dpno,jdbcType=VARCHAR},
      </if>
      <if test="isS != null">
        #{isS,jdbcType=VARCHAR},
      </if>
      <if test="bdUnit != null">
        #{bdUnit,jdbcType=VARCHAR},
      </if>
      <if test="spDate != null">
        #{spDate,jdbcType=TIMESTAMP},
      </if>
      <if test="unitAdr != null">
        #{unitAdr,jdbcType=VARCHAR},
      </if>
      <if test="bpno != null">
        #{bpno,jdbcType=VARCHAR},
      </if>
      <if test="ctype != null">
        #{ctype,jdbcType=VARCHAR},
      </if>
      <if test="license != null">
        #{license,jdbcType=VARCHAR},
      </if>
      <if test="homeTel != null">
        #{homeTel,jdbcType=VARCHAR},
      </if>
      <if test="homeAdr != null">
        #{homeAdr,jdbcType=VARCHAR},
      </if>
      <if test="homePost != null">
        #{homePost,jdbcType=VARCHAR},
      </if>
      <if test="myTel != null">
        #{myTel,jdbcType=VARCHAR},
      </if>
      <if test="myAdr != null">
        #{myAdr,jdbcType=VARCHAR},
      </if>
      <if test="myPost != null">
        #{myPost,jdbcType=VARCHAR},
      </if>
      <if test="wifeName != null">
        #{wifeName,jdbcType=VARCHAR},
      </if>
      <if test="wifeTel != null">
        #{wifeTel,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null">
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="outDate != null">
        #{outDate,jdbcType=TIMESTAMP},
      </if>
      <if test="delDate != null">
        #{delDate,jdbcType=TIMESTAMP},
      </if>
      <if test="pointProxy != null">
        #{pointProxy,jdbcType=VARCHAR},
      </if>
      <if test="humanOut != null">
        #{humanOut,jdbcType=VARCHAR},
      </if>
      <if test="isAd != null">
        #{isAd,jdbcType=VARCHAR},
      </if>
      <if test="pno != null">
        #{pno,jdbcType=VARCHAR},
      </if>
      <if test="humanOut1 != null">
        #{humanOut1,jdbcType=VARCHAR},
      </if>
      <if test="isS1 != null">
        #{isS1,jdbcType=VARCHAR},
      </if>
      <if test="pointProxy1 != null">
        #{pointProxy1,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.i84.earnpoint.model.UserMgInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update user_mg_info
    <set>
      <if test="uid != null">
        uid = #{uid,jdbcType=INTEGER},
      </if>
      <if test="msgfrom != null">
        msgfrom = #{msgfrom,jdbcType=VARCHAR},
      </if>
      <if test="isState != null">
        is_state = #{isState,jdbcType=CHAR},
      </if>
      <if test="smsg != null">
        smsg = #{smsg,jdbcType=VARCHAR},
      </if>
      <if test="dtype != null">
        dtype = #{dtype,jdbcType=VARCHAR},
      </if>
      <if test="dpno != null">
        dpno = #{dpno,jdbcType=VARCHAR},
      </if>
      <if test="isS != null">
        is_s = #{isS,jdbcType=VARCHAR},
      </if>
      <if test="bdUnit != null">
        bd_unit = #{bdUnit,jdbcType=VARCHAR},
      </if>
      <if test="spDate != null">
        sp_date = #{spDate,jdbcType=TIMESTAMP},
      </if>
      <if test="unitAdr != null">
        unit_adr = #{unitAdr,jdbcType=VARCHAR},
      </if>
      <if test="bpno != null">
        bpno = #{bpno,jdbcType=VARCHAR},
      </if>
      <if test="ctype != null">
        ctype = #{ctype,jdbcType=VARCHAR},
      </if>
      <if test="license != null">
        license = #{license,jdbcType=VARCHAR},
      </if>
      <if test="homeTel != null">
        home_tel = #{homeTel,jdbcType=VARCHAR},
      </if>
      <if test="homeAdr != null">
        home_adr = #{homeAdr,jdbcType=VARCHAR},
      </if>
      <if test="homePost != null">
        home_post = #{homePost,jdbcType=VARCHAR},
      </if>
      <if test="myTel != null">
        my_tel = #{myTel,jdbcType=VARCHAR},
      </if>
      <if test="myAdr != null">
        my_adr = #{myAdr,jdbcType=VARCHAR},
      </if>
      <if test="myPost != null">
        my_post = #{myPost,jdbcType=VARCHAR},
      </if>
      <if test="wifeName != null">
        wife_name = #{wifeName,jdbcType=VARCHAR},
      </if>
      <if test="wifeTel != null">
        wife_tel = #{wifeTel,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null">
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="outDate != null">
        out_date = #{outDate,jdbcType=TIMESTAMP},
      </if>
      <if test="delDate != null">
        del_date = #{delDate,jdbcType=TIMESTAMP},
      </if>
      <if test="pointProxy != null">
        point_proxy = #{pointProxy,jdbcType=VARCHAR},
      </if>
      <if test="humanOut != null">
        human_out = #{humanOut,jdbcType=VARCHAR},
      </if>
      <if test="isAd != null">
        is_ad = #{isAd,jdbcType=VARCHAR},
      </if>
      <if test="pno != null">
        pno = #{pno,jdbcType=VARCHAR},
      </if>
      <if test="humanOut1 != null">
        human_out1 = #{humanOut1,jdbcType=VARCHAR},
      </if>
      <if test="isS1 != null">
        is_s1 = #{isS1,jdbcType=VARCHAR},
      </if>
      <if test="pointProxy1 != null">
        point_proxy1 = #{pointProxy1,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.i84.earnpoint.model.UserMgInfo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update user_mg_info
    set uid = #{uid,jdbcType=INTEGER},
      msgfrom = #{msgfrom,jdbcType=VARCHAR},
      is_state = #{isState,jdbcType=CHAR},
      smsg = #{smsg,jdbcType=VARCHAR},
      dtype = #{dtype,jdbcType=VARCHAR},
      dpno = #{dpno,jdbcType=VARCHAR},
      is_s = #{isS,jdbcType=VARCHAR},
      bd_unit = #{bdUnit,jdbcType=VARCHAR},
      sp_date = #{spDate,jdbcType=TIMESTAMP},
      unit_adr = #{unitAdr,jdbcType=VARCHAR},
      bpno = #{bpno,jdbcType=VARCHAR},
      ctype = #{ctype,jdbcType=VARCHAR},
      license = #{license,jdbcType=VARCHAR},
      home_tel = #{homeTel,jdbcType=VARCHAR},
      home_adr = #{homeAdr,jdbcType=VARCHAR},
      home_post = #{homePost,jdbcType=VARCHAR},
      my_tel = #{myTel,jdbcType=VARCHAR},
      my_adr = #{myAdr,jdbcType=VARCHAR},
      my_post = #{myPost,jdbcType=VARCHAR},
      wife_name = #{wifeName,jdbcType=VARCHAR},
      wife_tel = #{wifeTel,jdbcType=VARCHAR},
      create_date = #{createDate,jdbcType=TIMESTAMP},
      out_date = #{outDate,jdbcType=TIMESTAMP},
      del_date = #{delDate,jdbcType=TIMESTAMP},
      point_proxy = #{pointProxy,jdbcType=VARCHAR},
      human_out = #{humanOut,jdbcType=VARCHAR},
      is_ad = #{isAd,jdbcType=VARCHAR},
      pno = #{pno,jdbcType=VARCHAR},
      human_out1 = #{humanOut1,jdbcType=VARCHAR},
      is_s1 = #{isS1,jdbcType=VARCHAR},
      point_proxy1 = #{pointProxy1,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
   
   <update id="ryxxCheckInfo" parameterType="java.util.Map">
    update user_mg_info
    <set>
      <if test="checkStatus != null">
        is_state = #{checkStatus,jdbcType=VARCHAR},
      </if>
      <if test="checkRemark != null">
        smsg = #{checkRemark,jdbcType=VARCHAR},
      </if>
      </set>
    where uid = #{uid,jdbcType=INTEGER}
  </update>
  
  <select id="selectUserMgInfoList" parameterType="java.util.HashMap" resultType="java.util.HashMap">
		SELECT
			a.dpno,
			a.pno,
			b.`name`,
			b.pnum,
			b.tel,
			b.sex,
			a.is_s,
            a.id,
            b.id as uid,
            a.id as aid,
            b.school,
            b.major
		FROM
			user_mg_info a  left join
	archives_base_info c on c.p_no = a.dpno
	,user_info b where b.id = a.uid and a.del_date is null and b.del_date is null

  		<if test="start != null ">
              AND c.in_date  &gt;=  #{start}
        </if>
        <if test=" end != null ">
              AND  c.in_date  &lt;=  #{end}
        </if>
	    <if test="dpno != null">
	        AND a.dpno = #{dpno}
	    </if>
	    <if test="pnum != null">
	        AND b.pnum = #{pnum}
	    </if>
	    <if test="isState != null">
	        AND a.is_state = #{isState}
	    </if>
	    <if test="name!=null and name!=''">
	        AND b.name like concat('%',#{name},'%')
	    </if>
	    <if test="age!=null and age!=''">
	        <choose>
	           <when test="age == 30">
	           	  AND FLOOR((DATEDIFF(CURRENT_DATE(),b.birth_date)/365)) &lt;=30
	           </when>
	           <when test="age == 40">
	              AND FLOOR((DATEDIFF(CURRENT_DATE(),b.birth_date)/365)) &gt;=31 AND FLOOR((DATEDIFF(CURRENT_DATE(),b.birth_date)/365)) &lt;=40
	           </when>
	           <when test="age == 50">
	              AND FLOOR((DATEDIFF(CURRENT_DATE(),b.birth_date)/365)) &gt;=41 AND FLOOR((DATEDIFF(CURRENT_DATE(),b.birth_date)/365)) &lt;=50
	           </when>
	           <otherwise>
	              AND FLOOR((DATEDIFF(CURRENT_DATE(),b.birth_date)/365)) &gt;=51
	           </otherwise>
	        </choose>
	       
	    </if>
	       group by a.dpno
    </select>
     
    <select id="countuUserMgInfoList" parameterType="java.util.HashMap" resultType="java.util.HashMap" >
		SELECT
				YEAR (a.create_date) 'name',
		    <if test="time_type == 'month' ">
		       MONTH (a.create_date) 'month' ,
		    </if>		
				COUNT(1) 'num'
		FROM
			user_mg_info a
			
	 	<if test="file_type == 'sj' ">	
			LEFT JOIN archives_base_info b ON b.p_no = a.dpno
		</if>
		
		WHERE
			a.del_date IS NULL
			
	    <if test="page_type =='pqtj' ">
	        AND a.is_s = 'on'
	    </if>
	    
        <if test="page_type =='rswbtj' ">
	        AND a.human_out = '是'
	    </if>
	    
        <if test="page_type =='dwdltj' ">
	        AND a.point_proxy = '是'
	    </if>
	        
     	<if test="file_type == 'sj' ">	
			  AND b.in_date!='null' 
			  AND (b.in_date  &gt;  b.out_date or b.out_date='null')
			  AND b.in_date  &gt;  b.out_date
		</if>
	    <if test="t_start != '' ">
              AND a.create_date  &gt;=  #{t_start}
        </if>
        <if test=" t_end != ''  ">
              AND  a.create_date  &lt;=  #{t_end}
        </if>
          
	    GROUP BY
			YEAR (a.create_date)
			<if test="time_type == 'month' ">
		       ,MONTH (a.create_date)
		    </if>
    </select>
    
    <select id="countuUserMgInfoListBySex" parameterType="java.util.HashMap" resultType="java.util.HashMap" >
		SELECT
				d.sex 'name',		 
				COUNT(1) 'num'
		FROM
			user_mg_info a
			LEFT JOIN user_info d ON d.id = a.uid			
 	 	<if test="file_type == 'sj' ">	
			LEFT JOIN archives_base_info b ON b.p_no = a.dpno
		</if>
		WHERE a.del_date IS NULL
	    
      	<if test="file_type == 'sj' ">	
			   AND b.in_date  &gt;  b.out_date
		</if>
	    <if test="t_start != '' ">
              AND a.create_date  &gt;=  #{t_start}
        </if>
        <if test=" t_end != ''  ">
              AND  a.create_date  &lt;=  #{t_end}
        </if>
  
	    GROUP BY
			 d.sex
    </select>

       <select id="selectmaxDpno" parameterType="java.util.HashMap" resultType="java.util.HashMap" >
      select max(dpno) maxDpno from user_info t where  t.dpno like  #{dtype,jdbcType=VARCHAR} ORDER BY dpno asc 
</select>

    <select id="countuUserMgInfoListByBirthday" parameterType="java.util.HashMap" resultType="java.util.HashMap" >
		SELECT
			   YEAR (d.birth_date) 'name',
		  	<if test="time_type == 'month' ">
		       MONTH (d.birth_date) 'month' ,
		    </if>	
				COUNT(1) 'num'
		FROM
			user_mg_info a
			LEFT JOIN user_info d ON d.id = a.uid			
 	 	<if test="file_type == 'sj' ">	
			LEFT JOIN archives_base_info b ON b.p_no = a.dpno
		</if>
		WHERE a.del_date IS NULL
      	<if test="file_type == 'sj' ">	
			   AND b.in_date  &gt;  b.out_date
		</if>
	    <if test="t_start != '' ">
              AND a.create_date  &gt;=  #{t_start}
        </if>
        <if test=" t_end != ''  ">
              AND  a.create_date  &lt;=  #{t_end}
        </if>
 		
	    GROUP BY
			YEAR (d.birth_date)
			<if test="time_type == 'month' ">
		       ,MONTH (d.birth_date)
		    </if>
    </select>
    
    <select id="getdabh" parameterType="java.util.HashMap" resultType="java.util.HashMap">
    
    select pno from user_mg_info where pno=#{pno,jdbcType=VARCHAR} 
    </select>
     <select id="getdabh1" parameterType="java.util.HashMap" resultType="java.util.HashMap">
    
    select dpno from user_mg_info where dpno=#{dpno,jdbcType=VARCHAR} 
    </select>
    
    <select id="countuUserMgInfoListByDegree" parameterType="java.util.HashMap" resultType="java.util.HashMap" >
		SELECT
			    d.degree  'name',	 
				COUNT(1) 'num'
		FROM
			user_mg_info a
			LEFT JOIN user_info d ON d.id = a.uid			
 	 	<if test="file_type == 'sj' ">	
			LEFT JOIN archives_base_info b ON b.p_no = a.dpno
		</if>
		WHERE
			a.del_date IS NULL
      	<if test="file_type == 'sj' ">	
			   AND b.in_date  &gt;  b.out_date
		</if>
	    <if test="t_start != '' ">
              AND a.create_date  &gt;=  #{t_start}
        </if>
        <if test=" t_end != ''  ">
              AND  a.create_date  &lt;=  #{t_end}
        </if>
 		
	    GROUP BY
			d.degree
			 
    </select>
    
    
    <select id="countuUserMgInfoListByZzmm" parameterType="java.util.HashMap" resultType="java.util.HashMap" >
		SELECT
			    d.zzmm  'name',	 
				COUNT(1) 'num'
		FROM
			user_mg_info a
			LEFT JOIN user_info d ON d.id = a.uid			
 	 	<if test="file_type == 'sj' ">	
			LEFT JOIN archives_base_info b ON b.p_no = a.dpno
		</if>
		WHERE
			a.del_date IS NULL
      	<if test="file_type == 'sj' ">	
			   AND b.in_date  &gt;  b.out_date
		</if>
	    <if test="t_start != '' ">
              AND a.create_date  &gt;=  #{t_start}
        </if>
        <if test=" t_end != ''  ">
              AND  a.create_date  &lt;=  #{t_end}
        </if>
 		
	    GROUP BY
			d.zzmm
			 
    </select>
    
    <select id="countuUserMgInfoListByDtype" parameterType="java.util.HashMap" resultType="java.util.HashMap" >
		SELECT
			    a.dtype  'name',	 
				COUNT(1) 'num'
		FROM
			user_mg_info a
			LEFT JOIN user_info d ON d.id = a.uid			
 	 	<if test="file_type == 'sj' ">	
			LEFT JOIN archives_base_info b ON b.p_no = a.dpno
		</if>
		WHERE
			a.del_date IS NULL
      	<if test="file_type == 'sj' ">	
			   AND b.in_date  &gt;  b.out_date
		</if>
	    <if test="t_start != '' ">
              AND a.create_date  &gt;=  #{t_start}
        </if>
        <if test=" t_end != ''  ">
              AND  a.create_date  &lt;=  #{t_end}
        </if>
 		
	    GROUP BY
			a.dtype
			 
    </select>
 
    <!-- 
    <select id="getNextDpno" resultType="java.lang.String">
	    SELECT
			*
		FROM
			(
				SELECT
					substring(t.dpno, 6) AS dpno
				FROM
					user_mg_info t
			) a
		WHERE
			a.dpno IS NOT NULL
		ORDER BY
			a.dpno DESC
		LIMIT 1
	</select>
	 -->
	 <select id="getNextdPno" resultType="java.lang.String" parameterType="java.util.Map">
	    select current_value from umi_sequence where sequ_name=#{s,jdbcType=VARCHAR}
	</select>
	<update id="updateNextDpno" parameterType="java.util.Map" >
	   update umi_sequence set current_value = current_value+1 where sequ_name=#{s,jdbcType=VARCHAR}
	</update>
	
	
	<select id="getNextPno" resultType="java.lang.String">
	    select current_value from umi_sequence where id=1
	</select>
	
	<update id="updateNextPno" >
	   update umi_sequence set current_value = current_value+1 where id=1
	</update>
	
	<update id="updateIsState" parameterType="java.util.Map">
    UPDATE USER_MG_INFO
    SET  IS_STATE = #{isState,jdbcType=INTEGER},
      DEL_DATE = #{delDate,jdbcType=TIMESTAMP}
    WHERE UID = #{uid,jdbcType=INTEGER}
  </update>
	 <select id="exportDaList-old"  resultType="com.i84.earnpoint.model.DaExportVo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
     SELECT
	a.name,
	a.sex,
	a.pnum,
	DATE_FORMAT( a.birth_date, '%Y/%m/%d') as birth_date,
	a.school,
	a.major,
	DATE_FORMAT( a.graduation_time, '%Y/%m/%d') as graduation_time,
	b.dpno bpno,
	c.p_state is_state,
	DATE_FORMAT( c.in_date, '%Y/%m/%d') as create_date
FROM
	user_info a,
	user_mg_info b left join
	archives_base_info c on c.p_no = b.dpno
		
WHERE
	b.uid = a.id  and   b.id in 
<foreach close=")" collection="array" index="index" item="item" open="(" separator=",">
	  #{item}
</foreach>
   group by b.dpno
</select>

<select id="exportDaList"  resultType="com.i84.earnpoint.model.DaExportVo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
     SELECT
     a.id,
d.org_name,
a.name,
a.dpno,
a.pnum,
a.sex,
DATE_FORMAT( a.birth_date, '%Y/%m/%d') as birth_date,
a.zzmm,
a.domicile_place,
a.work_name,
b.bd_unit,
a.degree,
a.major,
a.school,
DATE_FORMAT( a.graduation_time, '%Y/%m/%d') as graduation_time,
a.max_degree,
a.max_major,
a.max_school,
DATE_FORMAT( a.max_graduation_time, '%Y/%m/%d') as max_graduation_time,
b.unit_adr,
c.in_point,
c.in_date,
c.p_state
FROM user_info a 
left join user_mg_info b on a.id = b.uid
left join archives_base_info c on a.dpno = c.p_no
left join archives_info d on a.dpno = d.ar_no 
WHERE
	b.id in 
<foreach close=")" collection="array" index="index" item="item" open="(" separator=",">
	  #{item}
</foreach>
   group by b.dpno
</select>


<select id="exportAllDaList-old"  resultType="com.i84.earnpoint.model.DaExportVo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
     SELECT
	a.name,
	a.sex,
	a.pnum,
	DATE_FORMAT( a.birth_date, '%Y/%m/%d') as birth_date,
	a.school,
	a.major,
	DATE_FORMAT( a.graduation_time, '%Y/%m/%d') as graduation_time,
	b.dpno bpno,
	c.p_state is_state,
	DATE_FORMAT( c.in_date, '%Y/%m/%d') as create_date
FROM
	user_info a,
	user_mg_info b left join
	archives_base_info c on c.p_no = b.dpno
		
WHERE
	b.uid = a.id
   group by b.dpno
</select>

<select id="exportAllDaList"  resultType="com.i84.earnpoint.model.DaExportAllVo">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
SELECT
	a.id,
	d.org_name,
	a.NAME,
	a.dpno,
	a.pnum,
	a.sex,
	a.tel,
	DATE_FORMAT( a.birth_date, '%Y/%m/%d' ) AS birth_date,
	a.zzmm,
	a.domicile_place,
	a.work_name,
	b.bd_unit,
	a.degree,
	a.major,
	a.school,
	DATE_FORMAT( a.graduation_time, '%Y/%m/%d' ) AS graduation_time,
	a.max_degree,
	a.max_major,
	a.max_school,
	DATE_FORMAT( a.max_graduation_time, '%Y/%m/%d' ) AS max_graduation_time,
	b.unit_adr,
	c.in_point,
	c.in_date,
	c.p_state 
FROM
	user_info a
	LEFT JOIN user_mg_info b ON a.id = b.uid
	LEFT JOIN archives_base_info c ON a.dpno = c.p_no
	LEFT JOIN archives_info d ON a.dpno = d.ar_no
group by b.dpno
</select>



<update id="updateByUid" parameterType="com.i84.earnpoint.model.UserMgInfo">
    update user_mg_info
    <set>
      <if test="msgfrom != null and msgfrom!=''">
        msgfrom = #{msgfrom,jdbcType=VARCHAR},
      </if>
      <if test="isState != null and isState !=''">
        is_state = #{isState,jdbcType=CHAR},
      </if>
      <if test="smsg != null  and smsg !='' ">
        smsg = #{smsg,jdbcType=VARCHAR},
      </if>
      <if test="dtype != null and dtype !=''">
        dtype = #{dtype,jdbcType=VARCHAR},
      </if>
      <if test="dpno != null and dpno !=''">
        dpno = #{dpno,jdbcType=VARCHAR},
      </if>
      <if test="isS != null and isS !=''">
        is_s = #{isS,jdbcType=VARCHAR},
      </if>
       <if test="isS1 != null and isS1 !=''">
        is_s1 = #{isS1,jdbcType=VARCHAR},
      </if>
      <if test="bdUnit != null and bdUnit !='' ">
        bd_unit = #{bdUnit,jdbcType=VARCHAR},
      </if>
      <if test="spDate != null and spDate !='' ">
        sp_date = #{spDate,jdbcType=TIMESTAMP},
      </if>
      <if test="unitAdr != null and unitAdr !='' ">
        unit_adr = #{unitAdr,jdbcType=VARCHAR},
      </if>
      <if test="bpno != null and bpno !='' ">
        bpno = #{bpno,jdbcType=VARCHAR},
      </if>
      <if test="ctype != null and ctype !='' ">
        ctype = #{ctype,jdbcType=VARCHAR},
      </if>
      <if test="license != null and license !='' ">
        license = #{license,jdbcType=VARCHAR},
      </if>
      <if test="homeTel != null and homeTel !=''">
        home_tel = #{homeTel,jdbcType=VARCHAR},
      </if>
      <if test="homeAdr != null and homeAdr !=''">
        home_adr = #{homeAdr,jdbcType=VARCHAR},
      </if>
      <if test="homePost != null and homePost !=''">
        home_post = #{homePost,jdbcType=VARCHAR},
      </if>
      <if test="myTel != null and myTel !=''">
        my_tel = #{myTel,jdbcType=VARCHAR},
      </if>
      <if test="myAdr != null and myAdr !=''">
        my_adr = #{myAdr,jdbcType=VARCHAR},
      </if>
      <if test="myPost != null and myPost !=''">
        my_post = #{myPost,jdbcType=VARCHAR},
      </if>
      <if test="wifeName != null and wifeName !=''">
        wife_name = #{wifeName,jdbcType=VARCHAR},
      </if>
      <if test="wifeTel != null and wifeTel !=''">
        wife_tel = #{wifeTel,jdbcType=VARCHAR},
      </if>
      <if test="createDate != null and createDate !=''">
        create_date = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="outDate != null and outDate !=''">
        out_date = #{outDate,jdbcType=TIMESTAMP},
      </if>
      <if test="delDate != null and delDate !=''">
        del_date = #{delDate,jdbcType=TIMESTAMP},
      </if>
      <if test="pointProxy != null and pointProxy !=''">
        point_proxy = #{pointProxy,jdbcType=VARCHAR},
      </if>
      <if test="pointProxy1 != null and pointProxy1 !=''">
        point_proxy1 = #{pointProxy1,jdbcType=VARCHAR},
      </if>
      <if test="humanOut != null and humanOut !='' ">
        human_out = #{humanOut,jdbcType=VARCHAR},
      </if>
       <if test="humanOut1 != null and humanOut1 !='' ">
        human_out1 = #{humanOut1,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
    <select id="selectByUid" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from user_mg_info
    where uid = #{uid,jdbcType=INTEGER} limit 0,1
  </select>
  
  <select id="getUserMgInfoByPnum" parameterType="java.lang.String" resultType="java.util.HashMap">
      SELECT a.*,b.name FROM user_mg_info a
	  INNER JOIN user_info b ON a.uid= b.id
	  AND pnum=#{0} AND a.del_date IS NULL AND b.del_date IS NULL
	  LIMIT 1
  </select>
  
  <select id="getUserInfoByDpno_old" parameterType="java.lang.String"  resultType="java.util.HashMap">
        SELECT
			a.dpno,
			b.*
		FROM
			user_mg_info a,
			user_info b
		WHERE
			a.uid = b.id
		 AND  a.dpno=#{0}
		 LIMIT 1
  </select>
  
  <select id="getUserInfoByDpno" parameterType="java.lang.String"  resultType="java.util.HashMap">
		 SELECT
		    a.pnum,
		    a.tel,
		    a.tel userTel,
		    b.pno,
		    a.dpno,
		    a.name,
		    a.pnum,
		    a.sex,
		    b.is_s,
		    a.school,
		    a.major,
		    b.id,
		    a.id AS uid,
		    b.id AS aid
		FROM
		    user_info a
		LEFT JOIN user_mg_info b ON a.id = b.uid
		WHERE
		 a.dpno = #{0}
		LIMIT 1;
  </select>
  
</mapper>